{"version":3,"sources":["../../../app/controllers/novelList.js"],"names":["mongoose","require","async","wrap","Shuming","model","exports","index","req","res","page","query","_id","item","limit","options","criteria","list","result","count","send","pages","Math","ceil"],"mappings":"AAAA;;AAEA;;;;AAIA,IAAMA,WAAWC,QAAQ,UAAR,CAAjB;;eACwBA,QAAQ,IAAR,C;IAAVC,K,YAANC,I;;AACR,IAAMC,UAAUJ,SAASK,KAAT,CAAe,SAAf,CAAhB;;AAGA;;;;AAIAC,QAAQC,KAAR,GAAgBL,4CAAM,iBAAWM,GAAX,EAAgBC,GAAhB;AAAA;;AAAA;AAAA;AAAA;AAAA;AACZC,wBADY,GACL,CAACF,IAAIG,KAAJ,CAAUD,IAAV,GAAiB,CAAjB,GAAqBF,IAAIG,KAAJ,CAAUD,IAA/B,GAAsC,CAAvC,IAA4C,CADvC;AAEZE,uBAFY,GAENJ,IAAIG,KAAJ,CAAUE,IAFJ;AAGZC,yBAHY,GAGJ,EAHI;AAIZC,2BAJY,GAIF;AACZD,+BAAOA,KADK;AAEZJ,8BAAMA;AAFM,qBAJE;;;AASlB,wBAAIE,GAAJ,EAASG,QAAQC,QAAR,GAAmB,EAAEJ,QAAF,EAAnB;;AATS;AAAA,2BAWGR,QAAQa,IAAR,CAAaF,OAAb,CAXH;;AAAA;AAWZG,0BAXY;AAAA;AAAA,2BAYEd,QAAQe,KAAR,EAZF;;AAAA;AAYZA,yBAZY;;;AAclBV,wBAAIW,IAAJ,CAAS;AACLF,gCAAQA,MADH;AAELR,8BAAMA,OAAO,CAFR;AAGLW,+BAAOC,KAAKC,IAAL,CAAUJ,QAAQL,KAAlB;AAHF,qBAAT;;AAdkB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAN,EAAhB","file":"novelList.js","sourcesContent":["'use strict';\n\n/**\n * Module dependencies.\n */\n\nconst mongoose = require('mongoose');\nconst { wrap: async } = require('co');\nconst Shuming = mongoose.model('Shuming');\n\n\n/**\n * List\n */\n\nexports.index = async(function* (req, res) {\n    const page = (req.query.page > 0 ? req.query.page : 1) - 1;\n    const _id = req.query.item;\n    const limit = 30;\n    const options = {\n        limit: limit,\n        page: page\n    };\n\n    if (_id) options.criteria = { _id };\n\n    const result = yield Shuming.list(options);\n    const count = yield Shuming.count();\n\n    res.send({\n        result: result,\n        page: page + 1,\n        pages: Math.ceil(count / limit)\n    });\n\n});\n\n"]}